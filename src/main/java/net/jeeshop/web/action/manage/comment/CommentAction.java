package net.jeeshop.web.action.manage.comment;import net.jeeshop.core.BaseAction;import net.jeeshop.core.ManageContainer;import net.jeeshop.services.manage.comment.CommentService;import net.jeeshop.services.manage.comment.bean.Comment;import org.apache.commons.lang.StringUtils;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.context.annotation.Scope;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.ModelAttribute;import org.springframework.web.bind.annotation.RequestMapping;@Scope("prototype")   @Controller   @RequestMapping("/manage/comment")public class CommentAction extends BaseAction<Comment> {	private static final long serialVersionUID = 1L;	@Autowired	private CommentService commentService;	{		toList = "/manage/comment/commentList";		selectAllList = "redirect:selectList.action";		toAdd = "/manage/comment/commentEdit";		toEdit = "/manage/comment/commentEdit";	}		@ModelAttribute	public void initStrutsActionParam(){		this.server = commentService ;	}		protected void selectListAfter() {		pager.setPagerUrl(getBasePath()+"/manage/comment/selectList.action");	}	public Comment getE() {		return this.e;	}	public void prepare() throws Exception {		if (this.e == null) {			this.e = new Comment();		}		super.initPageSelect();	}	public void insertAfter(Comment e) {		e.clear();	}		/**	 * 设置选中的评论显示	 * @return	 * @throws Exception	 */	@RequestMapping("/updateStatusY")	public String updateStatusY() throws Exception{		if(getIds()!=null && getIds().length>0){			commentService.updateStatus(getIds(),Comment.comment_status_y);		}		return selectList();	}	/**	 * 设置选中的评论不显示	 * @return	 * @throws Exception	 */	@RequestMapping("/updateStatusN")	public String updateStatusN() throws Exception{		if(getIds()!=null && getIds().length>0){			commentService.updateStatus(getIds(),Comment.comment_status_n);		}		return selectList();	}		/**	 * 回复用户评论	 * @return	 * @throws Exception	 */	@RequestMapping("/updateReply")	public String updateReply() throws Exception{		if(StringUtils.isBlank(e.getReply()) || StringUtils.isBlank(e.getId())){			throw new NullPointerException(ManageContainer.OrderAction_param_null);		}//		String update = request.getParameter("update");//y:修改回复//		if(update.equals("y")){//			Comment ee = commentService.selectById(e.getId());//			if(ee==null){//				throw new NullPointerException("查询不到评论信息!");//			}//			//			ee.setReply(e.getReply());//		}				Comment c = new Comment();		c.setId(e.getId());		c.setReply(e.getReply());		commentService.update(c);		//		return selectList();		return super.selectAllList;	}		@Override	public String selectList() throws Exception {		return super.selectList();	}		@Override	protected void setParamWhenInitQuery() {		super.setParamWhenInitQuery();		String selectCommentFromIndex = request.getParameter("selectCommentFromIndex");		if(StringUtils.isNotBlank(selectCommentFromIndex)){			e.setSelectCommentFromIndex(Boolean.valueOf(selectCommentFromIndex));		}	}}