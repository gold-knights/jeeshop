package net.jeeshop.services.manage.questionnaireItem.impl;import java.util.List;import net.jeeshop.core.ServersManager;import net.jeeshop.services.manage.questionnaireItem.QuestionnaireItemService;import net.jeeshop.services.manage.questionnaireItem.bean.QuestionnaireItem;import net.jeeshop.services.manage.questionnaireItem.dao.QuestionnaireItemDao;import net.jeeshop.web.action.manage.order.OrderAction;import org.apache.commons.lang.StringUtils;import org.slf4j.LoggerFactory;public class QuestionnaireItemServiceImpl extends		ServersManager<QuestionnaireItem> implements QuestionnaireItemService {	private static final org.slf4j.Logger logger = LoggerFactory.getLogger(QuestionnaireItemServiceImpl.class);	private QuestionnaireItemDao questionnaireItemDao;	public void setQuestionnaireItemDao(			QuestionnaireItemDao questionnaireItemDao) {		this.questionnaireItemDao = questionnaireItemDao;	}		public void insertList(QuestionnaireItem questionnaireItem,List<QuestionnaireItem> itemList) {		logger.error("questionnaireItem.getType()="+questionnaireItem.getType());		logger.error("questionnaireItem="+questionnaireItem);		if(!questionnaireItem.getType().equals("text")){			if(itemList==null || itemList.size()==0){				throw new NullPointerException("保存题目和选项失败，原因是该题目没有任何选项");			}						if(StringUtils.isBlank(questionnaireItem.getId())){//新增				if(questionnaireItemDao.uniqeItem(itemList.get(0)) > 0){					throw new RuntimeException("一张问卷不允许出现相同的题目！");				}			}		}		//		QuestionnaireItem obj = null;//		if(questionnaireItem.getType().equals("text")){//			obj = questionnaireItem;//		}else{//			obj = itemList.get(0);//		}				if(StringUtils.isNotBlank(questionnaireItem.getId())){//修改题目之前需要先删除之前的题目记录			//删除该题目和选项//		QuestionnaireItem item = new QuestionnaireItem();//		item.setQid(obj.getQid());//		item.setSubject(obj.getSubject());			questionnaireItemDao.deleteQuestionItem(questionnaireItem);		}				if(questionnaireItem.getType().equals("text")){			questionnaireItem.setOption1("-");			questionnaireItemDao.insert(questionnaireItem);		}else{			//保存题目和选项			for(int i=0;i<itemList.size();i++){				QuestionnaireItem item = itemList.get(i);				item.setOrder1(questionnaireItem.getOrder1());				questionnaireItemDao.insert(item);			}		}	}	/**	 * 批量删除题目	 */	@Override	public int deletes(String[] ids) {		if(ids==null || ids.length==0){			throw new NullPointerException();//			for(int i=0;i<ids.length;i++){//				logger.error("deleteItem id = " + getIds()[i]);//			}		}				for(int i=0;i<ids.length;i++){			//查询题目			QuestionnaireItem item = questionnaireItemDao.selectById(ids[i]);			if(item==null){				throw new NullPointerException();			}			questionnaireItemDao.deleteQuestionItem(item);		}		return 0;	}}